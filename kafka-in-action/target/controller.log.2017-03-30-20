[INFO] [2017-03-30 22:14:08,181] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.KafkaController$SessionExpirationListener] - [SessionExpirationListener on 1], ZK expired; shut down all controller components and try to re-elect
[DEBUG] [2017-03-30 22:14:08,185] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.KafkaController] - [Controller 1]: Controller resigning, broker id 1
[DEBUG] [2017-03-30 22:14:08,185] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.KafkaController] - [Controller 1]: De-registering IsrChangeNotificationListener
[INFO] [2017-03-30 22:14:08,189] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.PartitionStateMachine] - [Partition state machine on Controller 1]: Stopped partition state machine
[INFO] [2017-03-30 22:14:08,189] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.ReplicaStateMachine] - [Replica state machine on controller 1]: Stopped replica state machine
[INFO] [2017-03-30 22:14:08,192] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-2-send-thread], Shutting down
[INFO] [2017-03-30 22:14:08,193] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-2-send-thread], Shutdown completed
[INFO] [2017-03-30 22:14:08,193] [Controller-1-to-broker-2-send-thread] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-2-send-thread], Stopped 
[INFO] [2017-03-30 22:14:08,196] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-1-send-thread], Shutting down
[INFO] [2017-03-30 22:14:08,198] [Controller-1-to-broker-1-send-thread] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-1-send-thread], Stopped 
[INFO] [2017-03-30 22:14:08,198] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-1-send-thread], Shutdown completed
[INFO] [2017-03-30 22:14:08,204] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-0-send-thread], Shutting down
[INFO] [2017-03-30 22:14:08,204] [Controller-1-to-broker-0-send-thread] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-0-send-thread], Stopped 
[INFO] [2017-03-30 22:14:08,204] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.RequestSendThread] - [Controller-1-to-broker-0-send-thread], Shutdown completed
[INFO] [2017-03-30 22:14:08,204] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.KafkaController] - [Controller 1]: Broker 1 resigned as the controller
[DEBUG] [2017-03-30 22:14:08,222] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.IsrChangeNotificationListener] - [IsrChangeNotificationListener] Fired!!!
[DEBUG] [2017-03-30 22:14:08,495] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.IsrChangeNotificationListener] - Sending MetadataRequest to Brokers:ArrayBuffer(0, 1, 2) for TopicAndPartitions:Set([__consumer_offsets,49], [__consumer_offsets,17], [__consumer_offsets,23], [__consumer_offsets,29], [__consumer_offsets,35], [__consumer_offsets,3], [__consumer_offsets,41], [__consumer_offsets,13], [__consumer_offsets,5], [__consumer_offsets,39], [__consumer_offsets,45], [__consumer_offsets,15], [__consumer_offsets,33], [__consumer_offsets,37], [__consumer_offsets,11], [__consumer_offsets,47], [__consumer_offsets,31], [__consumer_offsets,19], [__consumer_offsets,43], [__consumer_offsets,1])
[ERROR] [2017-03-30 22:14:08,585] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.ControllerBrokerRequestBatch] - Haven't been able to send metadata update requests, current state of the map is Map(2 -> Map(__consumer_offsets-49 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-19 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-13 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-35 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-5 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-43 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-37 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-29 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-23 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-45 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-15 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-31 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-1 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-17 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-39 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-47 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-3 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-41 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-11 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-33 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2)), 1 -> Map(__consumer_offsets-49 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-19 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-13 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-35 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-5 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-43 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-37 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-29 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-23 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-45 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-15 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-31 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-1 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-17 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-39 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-47 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-3 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-41 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-11 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-33 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2)), 0 -> Map(__consumer_offsets-49 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-19 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-13 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-35 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-5 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-43 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-37 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-29 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-23 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-45 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-15 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-31 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-1 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-17 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-39 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-47 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-3 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-41 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-11 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2), __consumer_offsets-33 -> (LeaderAndIsrInfo:(Leader:0,ISR:2,0,LeaderEpoch:7,ControllerEpoch:4),ReplicationFactor:2),AllReplicas:0,2))). Exception message: java.lang.NullPointerException
[ERROR] [2017-03-30 22:14:08,596] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.KafkaController] - [Controller 1]: Forcing the controller to resign
[INFO] [2017-03-30 22:14:08,631] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.ReplicaStateMachine$BrokerChangeListener] - [BrokerChangeListener on Controller 1]: Broker change listener fired for path /brokers/ids with children 0,1
[INFO] [2017-03-30 22:14:08,648] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.PartitionStateMachine$PartitionModificationsListener] - [AddPartitionsListener on 1]: Partition modification triggered {"version":1,"partitions":{"0":[2]}} for path /brokers/topics/avro_base_topic-test
[INFO] [2017-03-30 22:14:08,657] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.PartitionStateMachine$PartitionModificationsListener] - [AddPartitionsListener on 1]: Partition modification triggered {"version":1,"partitions":{"0":[1]}} for path /brokers/topics/avro_base_topic
[INFO] [2017-03-30 22:14:08,661] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.PartitionStateMachine$PartitionModificationsListener] - [AddPartitionsListener on 1]: Partition modification triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/avro_base_topic-1
[INFO] [2017-03-30 22:14:08,665] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.PartitionStateMachine$PartitionModificationsListener] - [AddPartitionsListener on 1]: Partition modification triggered {"version":1,"partitions":{"45":[0,2],"34":[2,0],"12":[2,0],"8":[2,0],"19":[0,2],"23":[0,2],"4":[2,0],"40":[2,0],"15":[0,2],"11":[0,2],"9":[0,2],"44":[2,0],"33":[0,2],"22":[2,0],"26":[2,0],"37":[0,2],"13":[0,2],"46":[2,0],"24":[2,0],"35":[0,2],"16":[2,0],"5":[0,2],"10":[2,0],"48":[2,0],"21":[0,2],"43":[0,2],"32":[2,0],"49":[0,2],"6":[2,0],"36":[2,0],"1":[0,2],"39":[0,2],"17":[0,2],"25":[0,2],"14":[2,0],"47":[0,2],"31":[0,2],"42":[2,0],"0":[2,0],"20":[2,0],"27":[0,2],"2":[2,0],"38":[2,0],"18":[2,0],"30":[2,0],"7":[0,2],"29":[0,2],"41":[0,2],"3":[0,2],"28":[2,0]}} for path /brokers/topics/__consumer_offsets
[INFO] [2017-03-30 22:14:08,751] [ZkClient-EventThread-16-localhost:2181] [kafka.controller.PartitionStateMachine$PartitionModificationsListener] - [AddPartitionsListener on 1]: Partition modification triggered {"version":1,"partitions":{"0":[2]}} for path /brokers/topics/avro_base_topic-2
