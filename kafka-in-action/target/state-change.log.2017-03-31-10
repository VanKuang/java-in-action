[TRACE] [2017-03-31 11:01:51,054] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,055] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,40] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,055] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,40]
[TRACE] [2017-03-31 11:01:51,055] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-40
[TRACE] [2017-03-31 11:01:51,055] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-40
[TRACE] [2017-03-31 11:01:51,055] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-40
[TRACE] [2017-03-31 11:01:51,056] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=29, replicas=[0, 2]) correlation id 5 from controller 2 epoch 13 for partition [__consumer_offsets,40]
[TRACE] [2017-03-31 11:01:51,056] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 5 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,40]
[TRACE] [2017-03-31 11:01:51,056] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,39]
[INFO] [2017-03-31 11:01:51,056] [kafka-request-handler-6] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 5 from controller 2 epoch 13 for partition [__consumer_offsets,40] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,056] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 5 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,40]
[TRACE] [2017-03-31 11:01:51,057] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,057] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 6
[TRACE] [2017-03-31 11:01:51,057] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,057] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,058] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,059] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=40,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,061] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,061] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,061] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,061] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,061] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-39
[TRACE] [2017-03-31 11:01:51,062] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-39
[TRACE] [2017-03-31 11:01:51,062] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-39
[TRACE] [2017-03-31 11:01:51,062] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 7 from controller 2 epoch 13 for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,062] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 7 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,063] [kafka-request-handler-5] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 7 for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,063] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 7 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:51,063] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,064] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,065] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 8
[TRACE] [2017-03-31 11:01:51,065] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,066] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,32] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,066] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,32]
[TRACE] [2017-03-31 11:01:51,067] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-32
[TRACE] [2017-03-31 11:01:51,067] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 9 from controller 2 epoch 13 for partition [__consumer_offsets,32]
[TRACE] [2017-03-31 11:01:51,067] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-32
[TRACE] [2017-03-31 11:01:51,067] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 9 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,32]
[INFO] [2017-03-31 11:01:51,067] [kafka-request-handler-0] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 9 from controller 2 epoch 13 for partition [__consumer_offsets,32] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,067] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 9 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,32]
[TRACE] [2017-03-31 11:01:51,067] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,068] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,068] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-32
[TRACE] [2017-03-31 11:01:51,068] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 10
[TRACE] [2017-03-31 11:01:51,068] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,068] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=39,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,068] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,069] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,070] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,070] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,070] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,071] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,071] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,071] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=32,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,071] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,071] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-13
[TRACE] [2017-03-31 11:01:51,071] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 11 from controller 2 epoch 13 for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,072] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-13
[TRACE] [2017-03-31 11:01:51,072] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 11 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,072] [kafka-request-handler-1] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 11 for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,072] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 11 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:51,072] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,073] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,073] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-13
[TRACE] [2017-03-31 11:01:51,073] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 12
[TRACE] [2017-03-31 11:01:51,073] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,073] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,074] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=13,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,075] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-21
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 13 from controller 2 epoch 13 for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-21
[TRACE] [2017-03-31 11:01:51,076] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 13 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,077] [kafka-request-handler-3] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 13 for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,077] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 13 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:51,077] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,077] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,077] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-21
[TRACE] [2017-03-31 11:01:51,078] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 14
[TRACE] [2017-03-31 11:01:51,078] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,079] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=21,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,080] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,081] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,081] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,12] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,081] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,12]
[TRACE] [2017-03-31 11:01:51,081] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-12
[TRACE] [2017-03-31 11:01:51,081] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-12
[TRACE] [2017-03-31 11:01:51,082] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-12
[TRACE] [2017-03-31 11:01:51,082] [kafka-request-handler-4] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 15 from controller 2 epoch 13 for partition [__consumer_offsets,12]
[TRACE] [2017-03-31 11:01:51,082] [kafka-request-handler-4] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 15 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,12]
[INFO] [2017-03-31 11:01:51,082] [kafka-request-handler-4] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 15 from controller 2 epoch 13 for partition [__consumer_offsets,12] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,082] [kafka-request-handler-4] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 15 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,12]
[TRACE] [2017-03-31 11:01:51,082] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,082] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,082] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,082] [kafka-request-handler-0] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 16
[TRACE] [2017-03-31 11:01:51,082] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,082] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,083] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=12,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,085] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,085] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,085] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,085] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,086] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 17 from controller 2 epoch 13 for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,086] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 17 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,086] [kafka-request-handler-2] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 17 for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,086] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 17 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:51,087] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,087] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-7
[TRACE] [2017-03-31 11:01:51,088] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-7
[TRACE] [2017-03-31 11:01:51,088] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 18
[TRACE] [2017-03-31 11:01:51,088] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,088] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-7
[TRACE] [2017-03-31 11:01:51,089] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,090] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=7,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,090] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,091] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,092] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,18] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,092] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,18]
[TRACE] [2017-03-31 11:01:51,092] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 19 from controller 2 epoch 13 for partition [__consumer_offsets,18]
[TRACE] [2017-03-31 11:01:51,092] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-18
[TRACE] [2017-03-31 11:01:51,093] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 19 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,18]
[INFO] [2017-03-31 11:01:51,093] [kafka-request-handler-6] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 19 from controller 2 epoch 13 for partition [__consumer_offsets,18] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,093] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-18
[TRACE] [2017-03-31 11:01:51,093] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 19 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,18]
[TRACE] [2017-03-31 11:01:51,093] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,093] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-18
[TRACE] [2017-03-31 11:01:51,093] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 20
[TRACE] [2017-03-31 11:01:51,093] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,094] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,094] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,094] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=18,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,095] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,096] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,24] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,096] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,24]
[TRACE] [2017-03-31 11:01:51,096] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-24
[TRACE] [2017-03-31 11:01:51,096] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-24
[TRACE] [2017-03-31 11:01:51,096] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 21 from controller 2 epoch 13 for partition [__consumer_offsets,24]
[TRACE] [2017-03-31 11:01:51,097] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 21 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,24]
[INFO] [2017-03-31 11:01:51,097] [kafka-request-handler-5] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 2 epoch 13 for partition [__consumer_offsets,24] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,097] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 21 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,24]
[TRACE] [2017-03-31 11:01:51,097] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,096] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-24
[TRACE] [2017-03-31 11:01:51,097] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,097] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 22
[TRACE] [2017-03-31 11:01:51,098] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,098] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,098] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=24,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,099] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,26] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,26]
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-26
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-26
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-26
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 23 from controller 2 epoch 13 for partition [__consumer_offsets,26]
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 23 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,26]
[INFO] [2017-03-31 11:01:51,100] [kafka-request-handler-0] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 23 from controller 2 epoch 13 for partition [__consumer_offsets,26] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,100] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 23 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,26]
[TRACE] [2017-03-31 11:01:51,101] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,101] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,101] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,101] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,101] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 24
[TRACE] [2017-03-31 11:01:51,101] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,101] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=26,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-19
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 25 from controller 2 epoch 13 for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 25 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,103] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-19
[TRACE] [2017-03-31 11:01:51,104] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-19
[TRACE] [2017-03-31 11:01:51,104] [kafka-request-handler-1] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 25 for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,104] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 25 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:51,104] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,104] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,105] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 26
[TRACE] [2017-03-31 11:01:51,105] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,106] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=19,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,106] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,107] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,108] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,22] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,108] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,22]
[TRACE] [2017-03-31 11:01:51,109] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-22
[TRACE] [2017-03-31 11:01:51,109] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-22
[TRACE] [2017-03-31 11:01:51,109] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 27 from controller 2 epoch 13 for partition [__consumer_offsets,22]
[TRACE] [2017-03-31 11:01:51,109] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 27 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,22]
[TRACE] [2017-03-31 11:01:51,109] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-22
[INFO] [2017-03-31 11:01:51,109] [kafka-request-handler-3] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 27 from controller 2 epoch 13 for partition [__consumer_offsets,22] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,109] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 27 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,22]
[TRACE] [2017-03-31 11:01:51,109] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,110] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,110] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 28
[TRACE] [2017-03-31 11:01:51,110] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,110] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,110] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=22,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,111] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,36] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,36]
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-36
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-36
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-4] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 29 from controller 2 epoch 13 for partition [__consumer_offsets,36]
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-4] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 29 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,36]
[TRACE] [2017-03-31 11:01:51,112] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-36
[INFO] [2017-03-31 11:01:51,113] [kafka-request-handler-4] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 29 from controller 2 epoch 13 for partition [__consumer_offsets,36] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,113] [kafka-request-handler-4] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 29 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,36]
[TRACE] [2017-03-31 11:01:51,113] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,113] [kafka-request-handler-0] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 30
[TRACE] [2017-03-31 11:01:51,113] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,113] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,114] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,114] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,115] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=36,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,116] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,117] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,117] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,117] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,117] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 31 from controller 2 epoch 13 for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,117] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 31 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,118] [kafka-request-handler-2] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 31 for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,118] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 31 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:51,120] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,120] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,120] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-49
[TRACE] [2017-03-31 11:01:51,121] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-49
[TRACE] [2017-03-31 11:01:51,121] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 32
[TRACE] [2017-03-31 11:01:51,121] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,121] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-49
[TRACE] [2017-03-31 11:01:51,121] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,122] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,122] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,124] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,124] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,124] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,124] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,125] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 33 from controller 2 epoch 13 for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,125] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 33 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,125] [kafka-request-handler-6] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 33 for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,125] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 33 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:51,126] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,129] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=27,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,130] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-27
[TRACE] [2017-03-31 11:01:51,130] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-27
[TRACE] [2017-03-31 11:01:51,130] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 34
[TRACE] [2017-03-31 11:01:51,131] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,131] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-27
[TRACE] [2017-03-31 11:01:51,131] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,132] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,132] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,136] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,136] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,136] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,137] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,137] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 35 from controller 2 epoch 13 for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,137] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 35 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,138] [kafka-request-handler-5] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 35 for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,138] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 35 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:51,138] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=11,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,139] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-11
[TRACE] [2017-03-31 11:01:51,139] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-11
[TRACE] [2017-03-31 11:01:51,140] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 36
[TRACE] [2017-03-31 11:01:51,140] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=11,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,140] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,140] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-11
[TRACE] [2017-03-31 11:01:51,141] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,141] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,142] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,144] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,46] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,144] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,46]
[TRACE] [2017-03-31 11:01:51,144] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 37 from controller 2 epoch 13 for partition [__consumer_offsets,46]
[TRACE] [2017-03-31 11:01:51,144] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 37 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,46]
[INFO] [2017-03-31 11:01:51,144] [kafka-request-handler-0] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 37 from controller 2 epoch 13 for partition [__consumer_offsets,46] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,144] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 37 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,46]
[TRACE] [2017-03-31 11:01:51,144] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-46
[TRACE] [2017-03-31 11:01:51,145] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,145] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-46
[TRACE] [2017-03-31 11:01:51,145] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 38
[TRACE] [2017-03-31 11:01:51,145] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,146] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,146] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-46
[TRACE] [2017-03-31 11:01:51,146] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,147] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,147] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=46,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,157] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,158] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,158] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,158] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,158] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-31
[TRACE] [2017-03-31 11:01:51,158] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 39 from controller 2 epoch 13 for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,159] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 39 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,159] [kafka-request-handler-1] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 39 for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,159] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 39 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:51,160] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,161] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=31,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,161] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 40
[TRACE] [2017-03-31 11:01:51,161] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-31
[TRACE] [2017-03-31 11:01:51,161] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,161] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-31
[TRACE] [2017-03-31 11:01:51,163] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,163] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,164] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,167] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,2] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,167] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,2]
[TRACE] [2017-03-31 11:01:51,167] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-2
[TRACE] [2017-03-31 11:01:51,167] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-2
[TRACE] [2017-03-31 11:01:51,168] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 41 from controller 2 epoch 13 for partition [__consumer_offsets,2]
[TRACE] [2017-03-31 11:01:51,168] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 41 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,2]
[INFO] [2017-03-31 11:01:51,168] [kafka-request-handler-3] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 41 from controller 2 epoch 13 for partition [__consumer_offsets,2] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,168] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 41 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,2]
[TRACE] [2017-03-31 11:01:51,168] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,168] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,169] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 42
[TRACE] [2017-03-31 11:01:51,169] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,169] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-2
[TRACE] [2017-03-31 11:01:51,169] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,170] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,170] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=2,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,172] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,172] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,172] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,172] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,173] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-45
[TRACE] [2017-03-31 11:01:51,173] [kafka-request-handler-4] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 43 from controller 2 epoch 13 for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,173] [kafka-request-handler-4] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 43 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,174] [kafka-request-handler-4] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 43 for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,174] [kafka-request-handler-4] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 43 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:51,174] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,175] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-45
[TRACE] [2017-03-31 11:01:51,175] [kafka-request-handler-0] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 44
[TRACE] [2017-03-31 11:01:51,175] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,175] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=45,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,176] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-45
[TRACE] [2017-03-31 11:01:51,176] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,177] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,177] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,42] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,42]
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-42
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-42
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-42
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 45 from controller 2 epoch 13 for partition [__consumer_offsets,42]
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 45 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,42]
[INFO] [2017-03-31 11:01:51,179] [kafka-request-handler-2] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 45 from controller 2 epoch 13 for partition [__consumer_offsets,42] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,179] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 45 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,42]
[TRACE] [2017-03-31 11:01:51,180] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,180] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,180] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,180] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 46
[TRACE] [2017-03-31 11:01:51,180] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,180] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=42,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,181] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,4] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,4]
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-4
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-4
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 47 from controller 2 epoch 13 for partition [__consumer_offsets,4]
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 47 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,4]
[INFO] [2017-03-31 11:01:51,183] [kafka-request-handler-6] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 47 from controller 2 epoch 13 for partition [__consumer_offsets,4] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,183] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 47 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,4]
[TRACE] [2017-03-31 11:01:51,184] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,184] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,184] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-4
[TRACE] [2017-03-31 11:01:51,184] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 48
[TRACE] [2017-03-31 11:01:51,184] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,184] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,185] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,185] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=4,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,186] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,187] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,187] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,187] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,187] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 49 from controller 2 epoch 13 for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,187] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 49 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,188] [kafka-request-handler-5] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 49 for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,188] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 49 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:51,188] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=41,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,189] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-41
[TRACE] [2017-03-31 11:01:51,190] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-41
[TRACE] [2017-03-31 11:01:51,191] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-41
[TRACE] [2017-03-31 11:01:51,191] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=41,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,192] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 50
[TRACE] [2017-03-31 11:01:51,192] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,193] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,194] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,196] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,196] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,6] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,196] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,6]
[TRACE] [2017-03-31 11:01:51,196] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-6
[TRACE] [2017-03-31 11:01:51,196] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-6
[TRACE] [2017-03-31 11:01:51,196] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-6
[TRACE] [2017-03-31 11:01:51,197] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 51 from controller 2 epoch 13 for partition [__consumer_offsets,6]
[TRACE] [2017-03-31 11:01:51,197] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 51 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,6]
[INFO] [2017-03-31 11:01:51,197] [kafka-request-handler-0] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 51 from controller 2 epoch 13 for partition [__consumer_offsets,6] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,197] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 51 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,6]
[TRACE] [2017-03-31 11:01:51,197] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,198] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,201] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,201] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 52
[TRACE] [2017-03-31 11:01:51,202] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,204] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=6,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,204] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,44] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,205] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,44]
[TRACE] [2017-03-31 11:01:51,205] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-44
[TRACE] [2017-03-31 11:01:51,205] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-44
[TRACE] [2017-03-31 11:01:51,205] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-44
[TRACE] [2017-03-31 11:01:51,205] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,205] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,206] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 53 from controller 2 epoch 13 for partition [__consumer_offsets,44]
[TRACE] [2017-03-31 11:01:51,206] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 53 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,44]
[INFO] [2017-03-31 11:01:51,206] [kafka-request-handler-1] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 53 from controller 2 epoch 13 for partition [__consumer_offsets,44] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,206] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 53 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,44]
[TRACE] [2017-03-31 11:01:51,207] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,207] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,207] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,209] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 54
[TRACE] [2017-03-31 11:01:51,209] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,209] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=44,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,210] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,210] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,210] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,210] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,211] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-37
[TRACE] [2017-03-31 11:01:51,211] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-37
[TRACE] [2017-03-31 11:01:51,211] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-37
[TRACE] [2017-03-31 11:01:51,211] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,212] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 55 from controller 2 epoch 13 for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,212] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 55 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,212] [kafka-request-handler-3] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 55 for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,213] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 55 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:51,213] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,217] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,217] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=37,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,218] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,219] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 56
[TRACE] [2017-03-31 11:01:51,219] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,220] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,221] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,221] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,222] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,222] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-1
[TRACE] [2017-03-31 11:01:51,224] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-1
[TRACE] [2017-03-31 11:01:51,224] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-1
[TRACE] [2017-03-31 11:01:51,224] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,226] [kafka-request-handler-4] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 57 from controller 2 epoch 13 for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,226] [kafka-request-handler-4] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 57 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,226] [kafka-request-handler-4] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 57 for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,226] [kafka-request-handler-4] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 57 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:51,228] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,229] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,232] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=1,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,234] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,235] [kafka-request-handler-0] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 58
[TRACE] [2017-03-31 11:01:51,235] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,237] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-47
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-47
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-47
[TRACE] [2017-03-31 11:01:51,238] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,241] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,242] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 59 from controller 2 epoch 13 for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,242] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 59 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,242] [kafka-request-handler-2] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 59 for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,242] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 59 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:51,244] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,245] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=47,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,245] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 60
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-17
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-17
[TRACE] [2017-03-31 11:01:51,246] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-17
[TRACE] [2017-03-31 11:01:51,250] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,254] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,255] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 61 from controller 2 epoch 13 for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,255] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 61 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,256] [kafka-request-handler-6] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 61 for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,256] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 61 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:51,261] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,262] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=17,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,263] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=17,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,266] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,266] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 62
[TRACE] [2017-03-31 11:01:51,268] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,268] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,14] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,14]
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-14
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-14
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 63 from controller 2 epoch 13 for partition [__consumer_offsets,14]
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-14
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 63 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,14]
[INFO] [2017-03-31 11:01:51,269] [kafka-request-handler-5] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 63 from controller 2 epoch 13 for partition [__consumer_offsets,14] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 63 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,14]
[TRACE] [2017-03-31 11:01:51,269] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,270] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,271] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,271] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 64
[TRACE] [2017-03-31 11:01:51,271] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,272] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=14,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,272] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,273] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-5
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-5
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-5
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 65 from controller 2 epoch 13 for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 65 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,274] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,275] [kafka-request-handler-0] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 65 for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,275] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 65 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:51,277] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,277] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=5,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,279] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=5,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,279] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 66
[TRACE] [2017-03-31 11:01:51,282] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,283] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,283] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,284] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,284] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,284] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,284] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-29
[TRACE] [2017-03-31 11:01:51,284] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-29
[TRACE] [2017-03-31 11:01:51,285] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-29
[TRACE] [2017-03-31 11:01:51,285] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,285] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 67 from controller 2 epoch 13 for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,285] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 67 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,286] [kafka-request-handler-1] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 67 for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,286] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 67 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:51,288] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=29,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,289] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,289] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=29,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,289] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 68
[TRACE] [2017-03-31 11:01:51,289] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,290] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,295] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,296] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,296] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,296] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,296] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-9
[TRACE] [2017-03-31 11:01:51,297] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-9
[TRACE] [2017-03-31 11:01:51,298] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-9
[TRACE] [2017-03-31 11:01:51,301] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 69 from controller 2 epoch 13 for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,301] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 69 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,302] [kafka-request-handler-3] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 69 for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,302] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 69 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:51,308] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,308] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,311] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 70
[TRACE] [2017-03-31 11:01:51,311] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,313] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=9,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,315] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,315] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,48] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,315] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,48]
[TRACE] [2017-03-31 11:01:51,316] [kafka-request-handler-4] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=29, replicas=[0, 2]) correlation id 71 from controller 2 epoch 13 for partition [__consumer_offsets,48]
[TRACE] [2017-03-31 11:01:51,316] [kafka-request-handler-4] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 71 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,48]
[INFO] [2017-03-31 11:01:51,317] [kafka-request-handler-4] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 71 from controller 2 epoch 13 for partition [__consumer_offsets,48] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,317] [kafka-request-handler-4] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 71 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,48]
[TRACE] [2017-03-31 11:01:51,317] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,317] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,317] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-48
[TRACE] [2017-03-31 11:01:51,318] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-48
[TRACE] [2017-03-31 11:01:51,318] [kafka-request-handler-0] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 72
[TRACE] [2017-03-31 11:01:51,318] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,319] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-48
[TRACE] [2017-03-31 11:01:51,319] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,319] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,319] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,320] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=48,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,323] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-23
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 73 from controller 2 epoch 13 for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 73 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-23
[TRACE] [2017-03-31 11:01:51,324] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-23
[TRACE] [2017-03-31 11:01:51,325] [kafka-request-handler-2] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 73 for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,325] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 73 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:51,325] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=23,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,325] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,325] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 74
[TRACE] [2017-03-31 11:01:51,326] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,327] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=23,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,328] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,328] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,20] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,328] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,20]
[TRACE] [2017-03-31 11:01:51,328] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,329] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-20
[TRACE] [2017-03-31 11:01:51,329] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 75 from controller 2 epoch 13 for partition [__consumer_offsets,20]
[TRACE] [2017-03-31 11:01:51,329] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 75 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,20]
[INFO] [2017-03-31 11:01:51,329] [kafka-request-handler-6] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 75 from controller 2 epoch 13 for partition [__consumer_offsets,20] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,329] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 75 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,20]
[TRACE] [2017-03-31 11:01:51,329] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,330] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-20
[TRACE] [2017-03-31 11:01:51,330] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 76
[TRACE] [2017-03-31 11:01:51,330] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,331] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,331] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-20
[TRACE] [2017-03-31 11:01:51,332] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,332] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,333] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=20,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,334] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,337] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,337] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,339] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,339] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 77 from controller 2 epoch 13 for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,339] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 77 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,339] [kafka-request-handler-5] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 77 for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,339] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 77 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:51,341] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,341] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-25
[TRACE] [2017-03-31 11:01:51,341] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-25
[TRACE] [2017-03-31 11:01:51,341] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 78
[TRACE] [2017-03-31 11:01:51,341] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,342] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=25,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,343] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-25
[TRACE] [2017-03-31 11:01:51,343] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,345] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,346] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,347] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,16] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,347] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,16]
[TRACE] [2017-03-31 11:01:51,348] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-16
[TRACE] [2017-03-31 11:01:51,349] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-16
[TRACE] [2017-03-31 11:01:51,349] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 79 from controller 2 epoch 13 for partition [__consumer_offsets,16]
[TRACE] [2017-03-31 11:01:51,349] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-16
[TRACE] [2017-03-31 11:01:51,349] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 79 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,16]
[INFO] [2017-03-31 11:01:51,349] [kafka-request-handler-2] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 79 from controller 2 epoch 13 for partition [__consumer_offsets,16] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,349] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 79 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,16]
[TRACE] [2017-03-31 11:01:51,350] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,350] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,351] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,351] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 80
[TRACE] [2017-03-31 11:01:51,351] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,351] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,352] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=16,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,354] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,354] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,354] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,355] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,355] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-35
[TRACE] [2017-03-31 11:01:51,355] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 81 from controller 2 epoch 13 for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,355] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 81 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,355] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-35
[TRACE] [2017-03-31 11:01:51,356] [kafka-request-handler-6] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 81 for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,356] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 81 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:51,357] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=35,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,357] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=35,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,358] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 82
[TRACE] [2017-03-31 11:01:51,358] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,358] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-35
[TRACE] [2017-03-31 11:01:51,358] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,358] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,359] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,361] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,34] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,361] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,34]
[TRACE] [2017-03-31 11:01:51,361] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-34
[TRACE] [2017-03-31 11:01:51,362] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-34
[TRACE] [2017-03-31 11:01:51,362] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 83 from controller 2 epoch 13 for partition [__consumer_offsets,34]
[TRACE] [2017-03-31 11:01:51,362] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 83 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,34]
[TRACE] [2017-03-31 11:01:51,362] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-34
[INFO] [2017-03-31 11:01:51,362] [kafka-request-handler-5] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 83 from controller 2 epoch 13 for partition [__consumer_offsets,34] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,362] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 83 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,34]
[TRACE] [2017-03-31 11:01:51,362] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,362] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,363] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 84
[TRACE] [2017-03-31 11:01:51,363] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,363] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,363] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,364] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=34,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,366] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,366] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,366] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,367] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,367] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-15
[TRACE] [2017-03-31 11:01:51,367] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 85 from controller 2 epoch 13 for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,367] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 85 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,367] [kafka-request-handler-0] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 85 for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,367] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 85 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:51,369] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,372] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 86
[TRACE] [2017-03-31 11:01:51,373] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=15,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,373] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,374] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-15
[TRACE] [2017-03-31 11:01:51,376] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,376] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-15
[TRACE] [2017-03-31 11:01:51,379] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,382] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,10] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,10]
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-10
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 87 from controller 2 epoch 13 for partition [__consumer_offsets,10]
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-10
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 87 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,10]
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-10
[INFO] [2017-03-31 11:01:51,386] [kafka-request-handler-1] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 87 from controller 2 epoch 13 for partition [__consumer_offsets,10] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,386] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 87 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,10]
[TRACE] [2017-03-31 11:01:51,387] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,387] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,387] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 88
[TRACE] [2017-03-31 11:01:51,387] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,387] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,387] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,388] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=10,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,389] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-3
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-3
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 89 from controller 2 epoch 13 for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 89 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,390] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-3
[TRACE] [2017-03-31 11:01:51,391] [kafka-request-handler-3] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 89 for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,391] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 89 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:51,391] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,391] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,391] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 90
[TRACE] [2017-03-31 11:01:51,392] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,393] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=3,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,394] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,395] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,28] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,28]
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-28
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-28
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-4] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 91 from controller 2 epoch 13 for partition [__consumer_offsets,28]
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-4] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 91 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,28]
[INFO] [2017-03-31 11:01:51,395] [kafka-request-handler-4] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 91 from controller 2 epoch 13 for partition [__consumer_offsets,28] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,395] [kafka-request-handler-4] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 91 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,28]
[TRACE] [2017-03-31 11:01:51,396] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,396] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-28
[TRACE] [2017-03-31 11:01:51,396] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,396] [kafka-request-handler-0] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 92
[TRACE] [2017-03-31 11:01:51,396] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,397] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,398] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=28,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,399] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,400] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,30] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,400] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,30]
[TRACE] [2017-03-31 11:01:51,400] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-30
[TRACE] [2017-03-31 11:01:51,400] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-30
[TRACE] [2017-03-31 11:01:51,401] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-30
[TRACE] [2017-03-31 11:01:51,401] [kafka-request-handler-2] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 93 from controller 2 epoch 13 for partition [__consumer_offsets,30]
[TRACE] [2017-03-31 11:01:51,401] [kafka-request-handler-2] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 93 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,30]
[INFO] [2017-03-31 11:01:51,401] [kafka-request-handler-2] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 93 from controller 2 epoch 13 for partition [__consumer_offsets,30] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,401] [kafka-request-handler-2] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 93 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,30]
[TRACE] [2017-03-31 11:01:51,401] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,401] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,401] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,401] [kafka-request-handler-1] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 94
[TRACE] [2017-03-31 11:01:51,402] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,402] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,402] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=30,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,404] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,404] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,404] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,404] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,405] [kafka-request-handler-6] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 95 from controller 2 epoch 13 for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,405] [kafka-request-handler-6] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 95 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,405] [kafka-request-handler-6] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 95 for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,405] [kafka-request-handler-6] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 95 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:51,406] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,406] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-43
[TRACE] [2017-03-31 11:01:51,407] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-43
[TRACE] [2017-03-31 11:01:51,407] [kafka-request-handler-3] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 96
[TRACE] [2017-03-31 11:01:51,407] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-43
[TRACE] [2017-03-31 11:01:51,407] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,407] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,407] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=43,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,408] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,409] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,0] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,0]
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-0
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-0
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-5] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 97 from controller 2 epoch 13 for partition [__consumer_offsets,0]
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-5] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 97 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,0]
[TRACE] [2017-03-31 11:01:51,410] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-0
[INFO] [2017-03-31 11:01:51,411] [kafka-request-handler-5] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 97 from controller 2 epoch 13 for partition [__consumer_offsets,0] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,411] [kafka-request-handler-5] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 97 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,0]
[TRACE] [2017-03-31 11:01:51,411] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,411] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,411] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 98
[TRACE] [2017-03-31 11:01:51,411] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,411] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,412] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=0,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,413] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,414] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,38] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,414] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,38]
[TRACE] [2017-03-31 11:01:51,414] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-38
[TRACE] [2017-03-31 11:01:51,414] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-38
[TRACE] [2017-03-31 11:01:51,414] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-38
[TRACE] [2017-03-31 11:01:51,415] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 99 from controller 2 epoch 13 for partition [__consumer_offsets,38]
[TRACE] [2017-03-31 11:01:51,415] [kafka-request-handler-0] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 99 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,38]
[INFO] [2017-03-31 11:01:51,415] [kafka-request-handler-0] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 99 from controller 2 epoch 13 for partition [__consumer_offsets,38] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,415] [kafka-request-handler-0] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 99 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,38]
[TRACE] [2017-03-31 11:01:51,415] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,415] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,415] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,415] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,415] [kafka-request-handler-2] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 100
[TRACE] [2017-03-31 11:01:51,415] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,416] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=38,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,417] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 elected leader 2 for Offline partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,417] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition with leader 2
[TRACE] [2017-03-31 11:01:51,417] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,417] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-follower LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,417] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-33
[TRACE] [2017-03-31 11:01:51,417] [kafka-request-handler-1] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 101 from controller 2 epoch 13 for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,418] [kafka-request-handler-1] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 101 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,418] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-33
[TRACE] [2017-03-31 11:01:51,418] [kafka-request-handler-1] [state.change.logger] - Broker 2 stopped fetchers as part of become-leader request from controller 2 epoch 13 with correlation id 101 for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,418] [kafka-request-handler-1] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 101 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:51,418] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-33
[TRACE] [2017-03-31 11:01:51,419] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,420] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,420] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,422] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,423] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=33,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,423] [kafka-request-handler-6] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 102
[TRACE] [2017-03-31 11:01:51,424] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,424] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,8] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:51,424] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,8]
[TRACE] [2017-03-31 11:01:51,424] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-8
[TRACE] [2017-03-31 11:01:51,425] [kafka-request-handler-3] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 103 from controller 2 epoch 13 for partition [__consumer_offsets,8]
[TRACE] [2017-03-31 11:01:51,425] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-8
[TRACE] [2017-03-31 11:01:51,425] [kafka-request-handler-3] [state.change.logger] - Broker 2 handling LeaderAndIsr request correlationId 103 from controller 2 epoch 13 starting the become-leader transition for partition [__consumer_offsets,8]
[TRACE] [2017-03-31 11:01:51,425] [kafka-request-handler-7] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 0 for partition __consumer_offsets-8
[INFO] [2017-03-31 11:01:51,425] [kafka-request-handler-3] [state.change.logger] - Broker 2 skipped the become-leader state change after marking its partition as leader with correlation id 103 from controller 2 epoch 13 for partition [__consumer_offsets,8] since it is already the leader for the partition.
[TRACE] [2017-03-31 11:01:51,425] [kafka-request-handler-3] [state.change.logger] - Broker 2 completed LeaderAndIsr request correlationId 103 from controller 2 epoch 13 for the become-leader transition for partition [__consumer_offsets,8]
[TRACE] [2017-03-31 11:01:51,425] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=8,error_code=0}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:51,425] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:01:51,425] [Controller-2-to-broker-0-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9092 (id: 0 rack: null)
[TRACE] [2017-03-31 11:01:51,425] [kafka-request-handler-5] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 104
[TRACE] [2017-03-31 11:01:51,426] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:54,694] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed partition [avro_base_topic-1,0] state from OnlinePartition to OfflinePartition
[TRACE] [2017-03-31 11:01:54,694] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [avro_base_topic-1,0]
[ERROR] [2017-03-31 11:01:54,696] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [avro_base_topic-1,0] from OfflinePartition to OnlinePartition failed
kafka.common.NoReplicaOnlineException: No replica for partition [avro_base_topic-1,0] is alive. Live brokers are: [Set(1, 2)], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:73)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:474)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply$mcV$sp(ReplicaStateMachine.scala:376)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1$$anonfun$apply$mcV$sp$1.apply(ReplicaStateMachine.scala:358)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:33)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply$mcV$sp(ReplicaStateMachine.scala:357)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener$$anonfun$handleChildChange$1.apply(ReplicaStateMachine.scala:356)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.ReplicaStateMachine$BrokerChangeListener.handleChildChange(ReplicaStateMachine.scala:355)
	at org.I0Itec.zkclient.ZkClient$10.run(ZkClient.java:843)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[TRACE] [2017-03-31 11:01:54,701] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [avro_base_topic-1,0] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,703] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,25] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,704] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,12] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,705] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,31] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,706] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,40] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,708] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,35] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,709] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,9] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,710] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,43] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,712] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,2] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,714] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,11] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,717] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,29] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,719] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,30] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,726] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,4] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,727] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,42] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,729] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,26] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,731] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,34] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,732] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,17] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,734] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,37] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,736] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,27] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,739] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,10] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,741] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,41] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,742] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,20] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,743] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,28] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,745] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,46] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,747] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,39] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,749] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,47] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,750] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,49] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,751] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,22] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,752] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,1] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,755] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,24] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,757] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,6] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,758] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,36] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,759] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,8] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,761] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,38] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,762] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,16] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,763] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,21] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,765] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,18] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,766] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,0] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,768] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,48] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,769] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,5] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,770] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,13] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,772] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,3] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,773] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,44] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,775] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,15] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,776] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,7] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,778] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,19] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,780] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,33] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,782] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,45] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,784] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,23] from OnlineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,785] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,32] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 changed state of replica 0 for partition [__consumer_offsets,14] from OfflineReplica to OfflineReplica
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,38]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,16]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,8]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,2]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,46]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,24]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,32]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,10]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,48]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,40]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,18]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,34]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,26]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,4]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,42]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,20]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,12]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,28]
[TRACE] [2017-03-31 11:01:54,787] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,6]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,44]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,36]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,14]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,30]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,22]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:54,788] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending become-leader LeaderAndIsr request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition [__consumer_offsets,0]
[TRACE] [2017-03-31 11:01:54,789] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-49
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,13]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,46]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,9]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,42]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,21]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,17]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,30]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,26]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,5]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,38]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,1]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,34]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,16]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,45]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,12]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,41]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,24]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,20]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,49]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,0]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,29]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,25]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,8]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,37]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,4]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,33]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=32, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,15]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=29, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,48]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,11]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,44]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,23]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,19]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,32]
[TRACE] [2017-03-31 11:01:54,789] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,28]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,7]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=29, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,40]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,3]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,36]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,47]
[TRACE] [2017-03-31 11:01:54,789] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-38
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,14]
[TRACE] [2017-03-31 11:01:54,790] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-27
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,43]
[TRACE] [2017-03-31 11:01:54,790] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-16
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,10]
[TRACE] [2017-03-31 11:01:54,790] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-8
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,22]
[TRACE] [2017-03-31 11:01:54,790] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-19
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,18]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,31]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=22, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,27]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=24, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,39]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,6]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=15, isr=[2], zkVersion=30, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,35]
[TRACE] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 received LeaderAndIsr request PartitionState(controllerEpoch=13, leader=2, leaderEpoch=14, isr=[2], zkVersion=19, replicas=[0, 2]) correlation id 105 from controller 2 epoch 13 for partition [__consumer_offsets,2]
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,13] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,46] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,9] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,42] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,21] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,17] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,30] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,26] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,5] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,38] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,1] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,34] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,16] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,45] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,12] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,41] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,24] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,20] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,49] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,0] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,29] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,25] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,8] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,790] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,37] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,4] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,33] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,15] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,48] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,11] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,44] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,23] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,19] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,32] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,28] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,7] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,40] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,3] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,36] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,47] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,14] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,43] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,10] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,22] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,18] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,31] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,27] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,39] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,6] since its associated leader epoch 14 is not higher than the current leader epoch 14
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,35] since its associated leader epoch 15 is not higher than the current leader epoch 15
[WARN] [2017-03-31 11:01:54,791] [kafka-request-handler-0] [state.change.logger] - Broker 2 ignoring LeaderAndIsr request from controller 2 with correlation id 105 epoch 13 for partition [__consumer_offsets,2] since its associated leader epoch 14 is not higher than the current leader epoch 14
[TRACE] [2017-03-31 11:01:54,790] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-2
[TRACE] [2017-03-31 11:01:54,791] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-13
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-46
[TRACE] [2017-03-31 11:01:54,792] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0,partitions=[{topic=__consumer_offsets,partition=49,error_code=11},{topic=__consumer_offsets,partition=38,error_code=11},{topic=__consumer_offsets,partition=16,error_code=11},{topic=__consumer_offsets,partition=27,error_code=11},{topic=__consumer_offsets,partition=8,error_code=11},{topic=__consumer_offsets,partition=19,error_code=11},{topic=__consumer_offsets,partition=2,error_code=11},{topic=__consumer_offsets,partition=13,error_code=11},{topic=__consumer_offsets,partition=24,error_code=11},{topic=__consumer_offsets,partition=46,error_code=11},{topic=__consumer_offsets,partition=35,error_code=11},{topic=__consumer_offsets,partition=5,error_code=11},{topic=__consumer_offsets,partition=43,error_code=11},{topic=__consumer_offsets,partition=21,error_code=11},{topic=__consumer_offsets,partition=32,error_code=11},{topic=__consumer_offsets,partition=10,error_code=11},{topic=__consumer_offsets,partition=37,error_code=11},{topic=__consumer_offsets,partition=48,error_code=11},{topic=__consumer_offsets,partition=29,error_code=11},{topic=__consumer_offsets,partition=40,error_code=11},{topic=__consumer_offsets,partition=18,error_code=11},{topic=__consumer_offsets,partition=7,error_code=11},{topic=__consumer_offsets,partition=45,error_code=11},{topic=__consumer_offsets,partition=34,error_code=11},{topic=__consumer_offsets,partition=23,error_code=11},{topic=__consumer_offsets,partition=26,error_code=11},{topic=__consumer_offsets,partition=4,error_code=11},{topic=__consumer_offsets,partition=15,error_code=11},{topic=__consumer_offsets,partition=42,error_code=11},{topic=__consumer_offsets,partition=20,error_code=11},{topic=__consumer_offsets,partition=9,error_code=11},{topic=__consumer_offsets,partition=31,error_code=11},{topic=__consumer_offsets,partition=12,error_code=11},{topic=__consumer_offsets,partition=1,error_code=11},{topic=__consumer_offsets,partition=17,error_code=11},{topic=__consumer_offsets,partition=28,error_code=11},{topic=__consumer_offsets,partition=6,error_code=11},{topic=__consumer_offsets,partition=39,error_code=11},{topic=__consumer_offsets,partition=44,error_code=11},{topic=__consumer_offsets,partition=36,error_code=11},{topic=__consumer_offsets,partition=47,error_code=11},{topic=__consumer_offsets,partition=25,error_code=11},{topic=__consumer_offsets,partition=3,error_code=11},{topic=__consumer_offsets,partition=14,error_code=11},{topic=__consumer_offsets,partition=41,error_code=11},{topic=__consumer_offsets,partition=30,error_code=11},{topic=__consumer_offsets,partition=33,error_code=11},{topic=__consumer_offsets,partition=11,error_code=11},{topic=__consumer_offsets,partition=22,error_code=11},{topic=__consumer_offsets,partition=0,error_code=11}]} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-35
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-24
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-5
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-43
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-32
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-21
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-10
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-37
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-48
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-40
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-29
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-18
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-7
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-34
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-45
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-23
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-26
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-4
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-15
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-42
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-20
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-31
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-9
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:13,ControllerEpoch:13) to broker 2 for partition avro_base_topic-1-0
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-12
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-1
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-28
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-17
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-6
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-39
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-44
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-47
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-36
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-14
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-25
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-3
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-41
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-30
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-11
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-22
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-33
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 2 for partition __consumer_offsets-0
[TRACE] [2017-03-31 11:01:54,792] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-49
[TRACE] [2017-03-31 11:01:54,793] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-38
[TRACE] [2017-03-31 11:01:54,793] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-27
[TRACE] [2017-03-31 11:01:54,795] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-13 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-46 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-9 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-42 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-21 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-17 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-30 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-26 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-5 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-38 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-1 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-34 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-16 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-45 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-12 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-41 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-24 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-20 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-49 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-0 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-29 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:-1,ISR:,LeaderEpoch:13,ControllerEpoch:13),ReplicationFactor:1),AllReplicas:0) for partition avro_base_topic-1-0 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-25 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-8 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-37 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-4 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-33 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-15 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-48 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-11 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-44 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-23 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-19 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-32 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,797] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-28 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-7 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-40 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-3 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-36 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-47 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-14 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-43 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-10 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-22 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-18 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-31 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-27 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-39 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-6 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-35 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [kafka-request-handler-4] [state.change.logger] - Broker 2 cached leader info (LeaderAndIsrInfo:(Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13),ReplicationFactor:2),AllReplicas:0,2) for partition __consumer_offsets-2 in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 106
[TRACE] [2017-03-31 11:01:54,798] [Controller-2-to-broker-2-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9094 (id: 2 rack: null)
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-16
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-8
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-19
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-2
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-13
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-46
[TRACE] [2017-03-31 11:01:54,798] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-35
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-24
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-5
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-43
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-32
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-21
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-10
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-37
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-48
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-40
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-29
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-18
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-7
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-34
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-45
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-23
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-26
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-4
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-15
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-42
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-20
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-31
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-9
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:-1,ISR:,LeaderEpoch:13,ControllerEpoch:13) to broker 1 for partition avro_base_topic-1-0
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-12
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-1
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-28
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-17
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-6
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-39
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-44
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-47
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-36
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-14
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-25
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-3
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-41
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-30
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-11
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-22
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:15,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-33
[TRACE] [2017-03-31 11:01:54,799] [ZkClient-EventThread-16-localhost:2181] [state.change.logger] - Controller 2 epoch 13 sending UpdateMetadata request (Leader:2,ISR:2,LeaderEpoch:14,ControllerEpoch:13) to broker 1 for partition __consumer_offsets-0
[TRACE] [2017-03-31 11:01:54,804] [Controller-2-to-broker-1-send-thread] [state.change.logger] - Controller 2 epoch 13 received response {error_code=0} for a request sent to broker localhost:9093 (id: 1 rack: null)
[TRACE] [2017-03-31 11:02:29,494] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,40]
[ERROR] [2017-03-31 11:02:29,495] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,495] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,495] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,39]
[ERROR] [2017-03-31 11:02:29,496] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,496] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,496] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,32]
[ERROR] [2017-03-31 11:02:29,497] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,497] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,497] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,13]
[ERROR] [2017-03-31 11:02:29,498] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,498] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,499] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,21]
[ERROR] [2017-03-31 11:02:29,500] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,500] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,501] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,12]
[ERROR] [2017-03-31 11:02:29,502] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,502] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,503] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,7]
[ERROR] [2017-03-31 11:02:29,504] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,504] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,504] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,18]
[ERROR] [2017-03-31 11:02:29,505] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,505] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,505] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,24]
[ERROR] [2017-03-31 11:02:29,506] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,506] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,506] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,26]
[ERROR] [2017-03-31 11:02:29,507] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,507] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,507] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,19]
[ERROR] [2017-03-31 11:02:29,508] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,508] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,508] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,22]
[ERROR] [2017-03-31 11:02:29,509] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,509] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,509] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,36]
[ERROR] [2017-03-31 11:02:29,510] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,510] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,510] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,49]
[ERROR] [2017-03-31 11:02:29,511] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,511] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,511] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,27]
[ERROR] [2017-03-31 11:02:29,512] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,512] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,512] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,11]
[ERROR] [2017-03-31 11:02:29,513] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,513] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,513] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,46]
[ERROR] [2017-03-31 11:02:29,514] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,514] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,514] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,31]
[ERROR] [2017-03-31 11:02:29,515] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,515] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,515] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,2]
[ERROR] [2017-03-31 11:02:29,516] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,516] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,516] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,45]
[ERROR] [2017-03-31 11:02:29,517] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,517] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,518] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,42]
[ERROR] [2017-03-31 11:02:29,518] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,518] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,519] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,4]
[ERROR] [2017-03-31 11:02:29,519] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,519] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,520] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,41]
[ERROR] [2017-03-31 11:02:29,520] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,520] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,521] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,6]
[ERROR] [2017-03-31 11:02:29,521] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,521] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,522] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,44]
[ERROR] [2017-03-31 11:02:29,522] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,523] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,523] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,37]
[ERROR] [2017-03-31 11:02:29,523] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,523] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,524] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,1]
[ERROR] [2017-03-31 11:02:29,525] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,525] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,525] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,47]
[ERROR] [2017-03-31 11:02:29,526] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,526] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,526] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,17]
[ERROR] [2017-03-31 11:02:29,527] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,527] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,527] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,14]
[ERROR] [2017-03-31 11:02:29,528] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,528] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,528] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,5]
[ERROR] [2017-03-31 11:02:29,529] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,529] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,529] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,29]
[ERROR] [2017-03-31 11:02:29,532] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,532] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,533] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,9]
[ERROR] [2017-03-31 11:02:29,535] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,535] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,535] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,48]
[ERROR] [2017-03-31 11:02:29,537] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,537] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,538] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,23]
[ERROR] [2017-03-31 11:02:29,539] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,539] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,539] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,20]
[ERROR] [2017-03-31 11:02:29,540] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,540] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,541] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,25]
[ERROR] [2017-03-31 11:02:29,542] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,542] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,542] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,16]
[ERROR] [2017-03-31 11:02:29,543] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,543] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,543] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,35]
[ERROR] [2017-03-31 11:02:29,544] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,544] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,544] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,34]
[ERROR] [2017-03-31 11:02:29,545] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,545] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,546] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,15]
[ERROR] [2017-03-31 11:02:29,546] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,546] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,547] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,10]
[ERROR] [2017-03-31 11:02:29,547] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,547] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,548] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,3]
[ERROR] [2017-03-31 11:02:29,548] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,549] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:29,549] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,28]
[ERROR] [2017-03-31 11:02:29,550] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,550] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,550] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,30]
[ERROR] [2017-03-31 11:02:29,552] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,552] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,552] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,43]
[ERROR] [2017-03-31 11:02:29,556] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,556] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,557] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,0]
[ERROR] [2017-03-31 11:02:29,558] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,558] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,558] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,38]
[ERROR] [2017-03-31 11:02:29,559] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,560] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,560] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,33]
[ERROR] [2017-03-31 11:02:29,561] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,561] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:29,561] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,8]
[ERROR] [2017-03-31 11:02:29,562] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:29,562] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,574] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,40]
[ERROR] [2017-03-31 11:02:34,576] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,576] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,577] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,39]
[ERROR] [2017-03-31 11:02:34,579] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,580] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,580] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,32]
[ERROR] [2017-03-31 11:02:34,582] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,583] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,583] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,13]
[ERROR] [2017-03-31 11:02:34,585] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,585] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,586] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,21]
[ERROR] [2017-03-31 11:02:34,589] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,589] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,590] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,12]
[ERROR] [2017-03-31 11:02:34,591] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,591] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,592] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,7]
[ERROR] [2017-03-31 11:02:34,595] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,595] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,595] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,18]
[ERROR] [2017-03-31 11:02:34,596] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,596] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,597] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,24]
[ERROR] [2017-03-31 11:02:34,598] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,598] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,598] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,26]
[ERROR] [2017-03-31 11:02:34,599] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,599] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,600] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,19]
[ERROR] [2017-03-31 11:02:34,600] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,601] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,601] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,22]
[ERROR] [2017-03-31 11:02:34,602] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,602] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,602] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,36]
[ERROR] [2017-03-31 11:02:34,603] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,603] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,604] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,49]
[ERROR] [2017-03-31 11:02:34,605] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,605] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,606] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,27]
[ERROR] [2017-03-31 11:02:34,607] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,607] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,607] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,11]
[ERROR] [2017-03-31 11:02:34,608] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,608] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,608] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,46]
[ERROR] [2017-03-31 11:02:34,609] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,609] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,609] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,31]
[ERROR] [2017-03-31 11:02:34,610] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,610] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,610] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,2]
[ERROR] [2017-03-31 11:02:34,611] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,611] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,611] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,45]
[ERROR] [2017-03-31 11:02:34,612] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,612] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,612] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,42]
[ERROR] [2017-03-31 11:02:34,613] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,613] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,613] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,4]
[ERROR] [2017-03-31 11:02:34,614] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,614] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,614] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,41]
[ERROR] [2017-03-31 11:02:34,615] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,615] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,615] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,6]
[ERROR] [2017-03-31 11:02:34,616] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,616] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,616] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,44]
[ERROR] [2017-03-31 11:02:34,617] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,617] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,617] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,37]
[ERROR] [2017-03-31 11:02:34,618] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,618] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,618] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,1]
[ERROR] [2017-03-31 11:02:34,619] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,619] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,619] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,47]
[ERROR] [2017-03-31 11:02:34,620] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,620] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,620] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,17]
[ERROR] [2017-03-31 11:02:34,621] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,621] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,621] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,14]
[ERROR] [2017-03-31 11:02:34,622] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,622] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,622] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,5]
[ERROR] [2017-03-31 11:02:34,623] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,623] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,623] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,29]
[ERROR] [2017-03-31 11:02:34,624] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,624] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,624] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,9]
[ERROR] [2017-03-31 11:02:34,625] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,625] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,625] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,48]
[ERROR] [2017-03-31 11:02:34,626] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,626] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,626] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,23]
[ERROR] [2017-03-31 11:02:34,627] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,627] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,627] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,20]
[ERROR] [2017-03-31 11:02:34,628] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,628] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,628] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,25]
[ERROR] [2017-03-31 11:02:34,629] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,629] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,629] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,16]
[ERROR] [2017-03-31 11:02:34,630] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,630] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,630] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,35]
[ERROR] [2017-03-31 11:02:34,631] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,631] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,631] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,34]
[ERROR] [2017-03-31 11:02:34,632] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,632] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,632] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,15]
[ERROR] [2017-03-31 11:02:34,633] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,633] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,633] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,10]
[ERROR] [2017-03-31 11:02:34,634] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,634] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,634] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,3]
[ERROR] [2017-03-31 11:02:34,635] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,635] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:34,635] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,28]
[ERROR] [2017-03-31 11:02:34,636] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,636] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,636] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,30]
[ERROR] [2017-03-31 11:02:34,637] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,637] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,637] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,43]
[ERROR] [2017-03-31 11:02:34,638] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,638] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,638] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,0]
[ERROR] [2017-03-31 11:02:34,639] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,640] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,640] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,38]
[ERROR] [2017-03-31 11:02:34,641] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,641] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,641] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,33]
[ERROR] [2017-03-31 11:02:34,643] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,643] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:34,643] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,8]
[ERROR] [2017-03-31 11:02:34,644] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:34,644] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,654] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,40]
[ERROR] [2017-03-31 11:02:39,655] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,655] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,40] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,40] due to: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,40] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,655] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,39]
[ERROR] [2017-03-31 11:02:39,656] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,656] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,39] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,39] due to: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,39] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,656] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,32]
[ERROR] [2017-03-31 11:02:39,657] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,657] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,32] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,32] due to: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,32] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,657] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,13]
[ERROR] [2017-03-31 11:02:39,658] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,659] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,13] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,13] due to: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,13] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,659] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,21]
[ERROR] [2017-03-31 11:02:39,660] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,660] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,21] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,21] due to: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,21] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,660] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,12]
[ERROR] [2017-03-31 11:02:39,661] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,661] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,12] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,12] due to: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,12] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,661] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,7]
[ERROR] [2017-03-31 11:02:39,662] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,662] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,7] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,7] due to: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,7] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,662] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,18]
[ERROR] [2017-03-31 11:02:39,663] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,663] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,18] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,18] due to: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,18] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,663] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,24]
[ERROR] [2017-03-31 11:02:39,664] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,664] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,24] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,24] due to: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,24] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,664] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,26]
[ERROR] [2017-03-31 11:02:39,665] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,665] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,26] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,26] due to: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,26] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,665] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,19]
[ERROR] [2017-03-31 11:02:39,666] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,666] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,19] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,19] due to: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,19] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,666] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,22]
[ERROR] [2017-03-31 11:02:39,667] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,667] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,22] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,22] due to: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,22] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,667] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,36]
[ERROR] [2017-03-31 11:02:39,668] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,668] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,36] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,36] due to: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,36] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,669] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,49]
[ERROR] [2017-03-31 11:02:39,670] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,670] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,49] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,49] due to: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,49] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,670] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,27]
[ERROR] [2017-03-31 11:02:39,671] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,671] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,27] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,27] due to: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,27] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,671] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,11]
[ERROR] [2017-03-31 11:02:39,672] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,672] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,11] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,11] due to: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,11] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,672] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,46]
[ERROR] [2017-03-31 11:02:39,673] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,673] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,46] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,46] due to: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,46] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,673] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,31]
[ERROR] [2017-03-31 11:02:39,674] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,674] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,31] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,31] due to: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,31] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,674] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,2]
[ERROR] [2017-03-31 11:02:39,675] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,675] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,2] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,2] due to: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,2] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,675] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,45]
[ERROR] [2017-03-31 11:02:39,676] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,676] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,45] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,45] due to: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,45] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,676] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,42]
[ERROR] [2017-03-31 11:02:39,677] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,677] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,42] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,42] due to: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,42] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,677] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,4]
[ERROR] [2017-03-31 11:02:39,678] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,678] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,4] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,4] due to: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,4] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,678] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,41]
[ERROR] [2017-03-31 11:02:39,679] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,679] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,41] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,41] due to: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,41] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,679] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,6]
[ERROR] [2017-03-31 11:02:39,680] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,680] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,6] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,6] due to: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,6] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,680] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,44]
[ERROR] [2017-03-31 11:02:39,681] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,681] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,44] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,44] due to: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,44] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,681] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,37]
[ERROR] [2017-03-31 11:02:39,682] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,682] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,37] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,37] due to: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,37] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,682] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,1]
[ERROR] [2017-03-31 11:02:39,684] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,684] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,1] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,1] due to: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,1] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,685] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,47]
[ERROR] [2017-03-31 11:02:39,685] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,686] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,47] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,47] due to: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,47] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,686] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,17]
[ERROR] [2017-03-31 11:02:39,687] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,687] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,17] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,17] due to: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,17] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,687] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,14]
[ERROR] [2017-03-31 11:02:39,688] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,688] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,14] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,14] due to: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,14] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,688] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,5]
[ERROR] [2017-03-31 11:02:39,689] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,689] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,5] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,5] due to: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,5] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,689] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,29]
[ERROR] [2017-03-31 11:02:39,690] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,690] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,29] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,29] due to: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,29] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,690] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,9]
[ERROR] [2017-03-31 11:02:39,691] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,691] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,9] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,9] due to: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,9] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,691] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,48]
[ERROR] [2017-03-31 11:02:39,692] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,692] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,48] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,48] due to: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,48] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,692] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,23]
[ERROR] [2017-03-31 11:02:39,693] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,693] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,23] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,23] due to: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,23] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,693] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,20]
[ERROR] [2017-03-31 11:02:39,694] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,694] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,20] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,20] due to: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,20] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,694] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,25]
[ERROR] [2017-03-31 11:02:39,694] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,694] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,25] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,25] due to: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,25] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,695] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,16]
[ERROR] [2017-03-31 11:02:39,696] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,696] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,16] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,16] due to: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,16] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,696] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,35]
[ERROR] [2017-03-31 11:02:39,696] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,696] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,35] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,35] due to: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,35] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,697] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,34]
[ERROR] [2017-03-31 11:02:39,697] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,697] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,34] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,34] due to: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,34] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,697] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,15]
[ERROR] [2017-03-31 11:02:39,698] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,698] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,15] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,15] due to: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,15] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,698] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,10]
[ERROR] [2017-03-31 11:02:39,699] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,699] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,10] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,10] due to: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,10] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,699] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,3]
[ERROR] [2017-03-31 11:02:39,700] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,700] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,3] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,3] due to: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,3] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
[TRACE] [2017-03-31 11:02:39,700] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,28]
[ERROR] [2017-03-31 11:02:39,701] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,701] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,28] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,28] due to: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,28] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,701] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,30]
[ERROR] [2017-03-31 11:02:39,702] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,702] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,30] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,30] due to: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,30] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,702] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,43]
[ERROR] [2017-03-31 11:02:39,703] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,703] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,43] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,43] due to: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,43] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,703] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,0]
[ERROR] [2017-03-31 11:02:39,703] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,703] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,0] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,0] due to: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,0] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,704] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,38]
[ERROR] [2017-03-31 11:02:39,704] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,704] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,38] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,38] due to: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,38] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,704] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,33]
[ERROR] [2017-03-31 11:02:39,705] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,705] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,33] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,33] due to: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,33] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 22 more
[TRACE] [2017-03-31 11:02:39,705] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 started leader election for partition [__consumer_offsets,8]
[ERROR] [2017-03-31 11:02:39,706] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
[ERROR] [2017-03-31 11:02:39,706] [kafka-request-handler-2] [state.change.logger] - Controller 2 epoch 13 initiated state change for partition [__consumer_offsets,8] from OnlinePartition to OnlinePartition failed
kafka.common.StateChangeFailedException: encountered error while electing leader for partition [__consumer_offsets,8] due to: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2.
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:367)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:207)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:146)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:145)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:145)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:269)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1$$anonfun$apply$mcV$sp$3.apply(KafkaController.scala:264)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply$mcV$sp(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3$$anonfun$apply$1.apply(KafkaController.scala:264)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:234)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:263)
	at kafka.controller.KafkaController$$anonfun$shutdownBroker$3.apply(KafkaController.scala:260)
	at scala.collection.immutable.HashSet$HashSet1.foreach(HashSet.scala:316)
	at scala.collection.immutable.HashSet$HashTrieSet.foreach(HashSet.scala:972)
	at kafka.controller.KafkaController.shutdownBroker(KafkaController.scala:260)
	at kafka.server.KafkaApis.handleControlledShutdownRequest(KafkaApis.scala:223)
	at kafka.server.KafkaApis.handle(KafkaApis.scala:85)
	at kafka.server.KafkaRequestHandler.run(KafkaRequestHandler.scala:60)
	at java.lang.Thread.run(Thread.java:745)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 2 for [__consumer_offsets,8] besides shutting down brokers 2
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:191)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:344)
	... 21 more
